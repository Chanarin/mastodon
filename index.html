<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Mastodon by michaelfester</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Mastodon</h1>
          <h2>A simple next-word prediction engine</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/michaelfester/mastodon/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/michaelfester/mastodon/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/michaelfester/mastodon" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a name="mastodon" class="anchor" href="#mastodon"><span class="octicon octicon-link"></span></a>Mastodon</h1>

<p>A simple next-word prediction engine</p>

<h2>
<a name="quick-start" class="anchor" href="#quick-start"><span class="octicon octicon-link"></span></a>Quick start</h2>

<pre><code># Fetch a sample corpus
$ mkdir data
$ mkdir data/samples
$ curl http://norvig.com/big.txt -o data/samples/big.txt

# Generate stats using NSP
$ mkdir data/output
$ cd scripts
$ ./generate_stats.sh ../data/samples/big.txt ../data/output/

# Create binary dictionaries
$ cd ..
$ mkdir dictionaries
$ mkdir dictionaries/test
$ cd python
$ python makedict.py -u ../data/output/unigrams.txt -n ../data/output/ngrams2.ll,..$ /data/output/ngrams3.ll,../data/output/ngrams4.ll -o ../dictionaries/test/big.dict

# Create binary dictionaries for unit tests
$ python makedict.py -t
$ python unittests.py
$ cd ../cpp
$ make test
</code></pre>

<h2>
<a name="generating-statistics" class="anchor" href="#generating-statistics"><span class="octicon octicon-link"></span></a>Generating statistics</h2>

<p>To create a binary dictionary, we need data created from the N-Gram Statistics Package (NSP), available at <a href="http://www.d.umn.edu/%7Etpederse/nsp.html">http://www.d.umn.edu/~tpederse/nsp.html</a>. The script <code>generate_stats.sh</code> in the <code>scripts/</code> folder serves this purpose.</p>

<p>A sample corpus can be found at <a href="http://norvig.com/big.txt">http://norvig.com/big.txt</a>.</p>

<pre><code>$ curl https://dl.dropbox.com/u/228601/8pen/big.txt -o data/samples/big.txt
</code></pre>

<p>We can generate the desired statistics in the following way:</p>

<pre><code>$ cd scripts
$ ./generate_stats.sh INPUT_FILE OUTPUT_DIR
</code></pre>

<h3>
<a name="unigrams" class="anchor" href="#unigrams"><span class="octicon octicon-link"></span></a>Unigrams</h3>

<p>The script generates a simple word frequency list <code>unigram.txt</code> in <code>OUTPUT_DIR</code>, in which each line is of the form <code>weight unigram</code>. Example output:</p>

<pre><code>79377 the
39997 of
38076 and
28604 to
21780 in
20910 a
...
</code></pre>

<p>The weight is simply the number of occurences of the corresponding word in the corpus.</p>

<h3>
<a name="n-grams" class="anchor" href="#n-grams"><span class="octicon octicon-link"></span></a>N-grams</h3>

<p>The script then generates a lists of bi-, tri-, and four-grams (<code>ngrams2.ll</code>, <code>ngrams3.ll</code>, <code>ngrams4.ll</code>, also locaed in <code>OUTPUT_DIR</code>) of the form <code>unigram&lt;&gt;unigram&lt;&gt;...&lt;&gt;rank weight</code> (we ignore <code>rank</code> for now). Example output:</p>

<pre><code>of&lt;&gt;the&lt;&gt;2 25053.6988
in&lt;&gt;the&lt;&gt;6 10335.9606
did&lt;&gt;not&lt;&gt;8 9798.6723
</code></pre>

<h2>
<a name="generating-dictionaries" class="anchor" href="#generating-dictionaries"><span class="octicon octicon-link"></span></a>Generating dictionaries</h2>

<p>To generate a binary dictionary using output of the NSP, a script <code>makedict.py</code> in the <code>python/</code> folder is available. Example usage:</p>

<pre><code>$ python makedict.py -u UNIGRAM_FILE -n BIGRAM_FILE,TRIGRAM_FILE,FOURGRAM_FILE -o OUTPUT_FILE
</code></pre>

<h2>
<a name="using-dictionaries" class="anchor" href="#using-dictionaries"><span class="octicon octicon-link"></span></a>Using dictionaries</h2>

<p>Implementations in Python and C++ are currently available for loading a binary dictionary and querying it for:</p>

<ul>
<li>Corrections</li>
<li>Completions (Python only)</li>
<li>Next-word predictions</li>
</ul><h3>
<a name="python" class="anchor" href="#python"><span class="octicon octicon-link"></span></a>Python</h3>

<p>Here is a simple usage in Python:</p>

<pre><code>bindict = BinaryDictionary.from_file('../dictionaries/test/test.dict')
bindict.get_predictions(['hello']) # =&gt; [('there',10),('sir',3)]
bindict.get_corrections('yuur')    # =&gt; ['your','you','year']
bindict.get_completions('yo', 2)   # =&gt; ['you','your']
</code></pre>

<h3>
<a name="c" class="anchor" href="#c"><span class="octicon octicon-link"></span></a>C++</h3>

<p>Here is a simple usage in C++:</p>

<pre><code>BinaryDictionary bindict;
bindict.fromFile("../dictionaries/test/test.dict");

string phrase[] = {"how", "are"};
vector&lt;weighted_string&gt; holder;
vector&lt;weighted_string&gt; predictions = bindict.getPredictions(phrase, 2, holder, 4);

vector&lt;weighted_string&gt; holder;
vector&lt;weighted_string&gt; corrections = bindict.getCorrections("you", holder, 100);
</code></pre>

<p>Note that querying for word completions is not yet implemented in C++.</p>

<h2>
<a name="unit-tests" class="anchor" href="#unit-tests"><span class="octicon octicon-link"></span></a>Unit tests</h2>

<p>The unit tests are designed to be used with a simple dictionary, located at <code>dictionaries/test/test.dict</code>, and generated using the <code>-t</code> option:</p>

<pre><code>$ python makedict.py -t
</code></pre>

<h3>
<a name="python-1" class="anchor" href="#python-1"><span class="octicon octicon-link"></span></a>Python</h3>

<p>The Python unit tests use the <code>unittest</code> module, and are available in <code>python/unittests.py</code>:</p>

<pre><code>$ python unittests.py
</code></pre>

<h3>
<a name="c-1" class="anchor" href="#c-1"><span class="octicon octicon-link"></span></a>C++</h3>

<p>The C++ unit tests, located at <code>cpp/tests/unit/test.cpp</code>, are based on the <code>UnitTest++</code> framework (included). Simply use the provided <code>Makefile</code> in the <code>cpp</code> folder to run the tests:</p>

<pre><code>$ make test
</code></pre>

<h2>
<a name="generating-statistics-1" class="anchor" href="#generating-statistics-1"><span class="octicon octicon-link"></span></a>Generating statistics</h2>

<h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p>Mastodon is released under the MIT license. See <a href="https://github.com/michaelfester/mastodon/blob/develop/LICENSE.md">LICENSE.md</a>.</p>
        </section>

        <footer>
          Mastodon is maintained by <a href="https://github.com/michaelfester">michaelfester</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

                  <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-41258693-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

      </div>
    </div>
  </body>
</html>